name: Assemble android
on:
  workflow_dispatch:
   inputs:
     build_type:
       description: 'appbundle или apk'
       required: true
       default: appbundle
       type: choice
       options:
         - appbundle
         - apk
     build_mode:
       description: 'release, profile или debug'
       required: true
       default: release
       type: choice
       options:
         - release
         - profile
         - debug
     flavor:
       description: 'prod,stage,dev'
       required: true
       default: prod
       type: choice
       options:
         - prod
         - stage
         - dev
jobs:
  assemble_android:
    runs-on: [ self-hosted, android_builder ]
    steps:
      - uses: actions/checkout@v3
      - name: Setup
        uses: ./.github/actions/setup
      - name: Check
        if: ${{ success() }}
        uses: ./.github/actions/check
      - name: Assemble
        if: ${{ success() }}
        uses: ./.github/actions/assemble_android
        with:
          build_type: ${{ github.event.inputs.build_type }}
          build_mode: ${{ github.event.inputs.build_mode }}
          flavor: ${{ github.event.inputs.flavor }}
          decript_key: ${{ secrets.ANDROID_KEYS_SECRET_PASSPHRASE }}